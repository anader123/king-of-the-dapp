(this["webpackJsonpking-of-the-dapp"]=this["webpackJsonpking-of-the-dapp"]||[]).push([[0],{162:function(e){e.exports=JSON.parse('{"a":[{"constant":true,"inputs":[],"name":"King","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"kingRansom","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[],"payable":true,"stateMutability":"payable","type":"constructor"},{"payable":true,"stateMutability":"payable","type":"fallback"},{"anonymous":false,"inputs":[{"indexed":true,"name":"_newKing","type":"address"},{"indexed":false,"name":"_kingRansom","type":"uint256"}],"name":"Coronation","type":"event"},{"constant":false,"inputs":[],"name":"becomeKing","outputs":[],"payable":true,"stateMutability":"payable","type":"function"}]}')},163:function(e,t,n){e.exports=n.p+"static/media/ethlogo.bdc70232.png"},167:function(e,t,n){e.exports=n(422)},172:function(e,t,n){},173:function(e,t,n){},174:function(e,t,n){},175:function(e,t,n){},186:function(e,t){},209:function(e,t){},211:function(e,t){},251:function(e,t){},253:function(e,t){},284:function(e,t){},397:function(e,t,n){},398:function(e,t,n){},422:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),r=n(76),c=n.n(r);n(172),n(173),n(174),n(175);function s(){return o.a.createElement("div",{className:"header-container"},o.a.createElement("h1",{className:"header-title"},"King of the Dapp"))}var i=n(12),l=n.n(i),u=n(56),m=n(159),d=n(160),p=n(165),h=n(161),g=n(166),f=n(77),k=n.n(f),b=n(162),E=n(29),v=n.n(E),w=n(25),A=n.n(w),y=n(163),x=n.n(y),C=function(){return A()({icon:"error",title:"Network Error",text:"Please switch to the Ropsten Test Network in your MetaMask extension"})},N=function(e){return A()({icon:"success",title:"Tx Successfully Sent",closeOnClickOutside:!1,content:o.a.createElement("div",null,o.a.createElement("p",null,"Transaction Hash:"),o.a.createElement("p",null,o.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://ropsten.etherscan.io/tx/".concat(e.transactionHash)},e.transactionHash)))})},S=function(){return A()({icon:"error",title:"Invalid Amount",text:"The ETH amount you have entered is not enough.",button:!0})},M=function(){return A()({closeOnClickOutside:!1,button:!1,content:o.a.createElement("div",null,o.a.createElement("img",{className:"block-load-img",src:x.a,alt:"block loading"}),o.a.createElement("p",null,"Blockchain magic in progress..."),o.a.createElement("br",null))})},R=function(){return A()({icon:"error",title:"Error",text:"An error has occurred.",button:!0})},I=function(){return A()({icon:"error",title:"Ethereum Wallet Missing",text:"Please make sure that you have an Ethereum wallet installed.",button:!0})};v.a.config({DECIMAL_PLACES:4});var B=function(e){return new v.a(e).shiftedBy(-18).toString(10)};n(397);function O(e){var t=e.connectWallet;return o.a.createElement("div",{className:"connect-container"},o.a.createElement("p",{className:"mm-message"},"Please make sure that you are connected to the Ropsten Test Network."),o.a.createElement("button",{onClick:t},"Connect Wallet"),o.a.createElement("a",{className:"mm-download",target:"_blank",rel:"noopener noreferrer",href:"https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn"},"Download MetaMask"))}n(398);var K=n(164),T=n.n(K);function j(e){var t=e.userAccount,n=e.ethBalance,a=e.kingRansom,r=e.kingAddress,c=e.kingMe,s=e.handleInputAmountChange,i=e.kingInputAmount,l=e.loading,u=T.a.createDataURL({seed:r});return o.a.createElement("div",{className:"dashboard-container"},o.a.createElement("div",{className:"user-info-container"},o.a.createElement("p",{className:"user-address"},"Your Address: ",t),o.a.createElement("div",null,o.a.createElement("span",null,"Balance:")," ",l?o.a.createElement("span",null,"Loading"):o.a.createElement("span",null,n," ETH"))),l?o.a.createElement("div",{className:"loading-text"},"Loading..."):o.a.createElement("div",null,o.a.createElement("div",{className:"king-info-container"},o.a.createElement("img",{className:"blockie-img",alt:"eth-blockie",src:u}),o.a.createElement("p",{className:"king-address"},"King: ",r),o.a.createElement("p",null,"King's Ransom: ",a," ETH"))),o.a.createElement("div",{className:"input-container"},o.a.createElement("input",{className:"input-box",onChange:s,value:i,type:"number"}),o.a.createElement("button",{className:"input-btn",onClick:c},"King Me"),o.a.createElement("p",{className:"input-text"},"*The amount entered must be at least 0.1 ETH more than the current amount.")),o.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://medium.com/@0xnaderdev/king-of-the-dapp-an-overview-on-how-to-create-a-react-interface-for-an-ethereum-smart-contract-de53334619ea"},o.a.createElement("p",{className:"medium-link"},"Read the tutorial on Medium.")))}var W=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(p.a)(this,Object(h.a)(t).call(this))).connectWallet=Object(u.a)(l.a.mark((function t(){var n,a,o,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.state.contractAddress,a=new k.a(k.a.givenProvider),o=new a.eth.Contract(b.a,n),!window.ethereum){t.next=22;break}if("3"!==window.ethereum.networkVersion){t.next=19;break}return t.prev=5,t.next=8,window.ethereum.enable();case 8:r=t.sent,e.setState({walletConnected:!0,userAccount:r[0],contract:o,web3:a}),e.methodContainer(r),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(5),console.log(t.t0),R();case 17:t.next=20;break;case 19:C();case 20:t.next=23;break;case 22:I();case 23:case"end":return t.stop()}}),t,null,[[5,13]])}))),e.methodContainer=function(t){e.checkContractInfo(),e.checkCurrentAccount(),e.checkEthBalance(t[0])},e.checkContractInfo=Object(u.a)(l.a.mark((function t(){var n,a,o,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.state.contract)){t.next=20;break}return t.prev=2,t.next=5,n.methods.King().call();case 5:return a=t.sent,t.next=8,n.methods.kingRansom().call();case 8:o=t.sent,r=B(o),e.setState({kingRansom:r,kingAddress:a,loading:!1}),e.coronationSubscription(n),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(2),console.log(t.t0),R();case 18:t.next=22;break;case 20:console.log("contract is not defined"),R();case 22:case"end":return t.stop()}}),t,null,[[2,14]])}))),e.coronationSubscription=function(t){var n=t.events.Coronation().on("data",(function(t){var n=t.returnValues._newKing,a=B(t.returnValues._kingRansom);e.setState({kingAddress:n,kingRansom:a})})).on("error",(function(e){console.log(e),R()}));e.setState({coronationSub:n})},e.checkEthBalance=function(t){var n=e.state.web3;t?n.eth.getBalance(t,(function(t,n){if(t)console.log(t),R();else{var a=B(n);e.setState({ethBalance:a})}})):e.setState({walletConnected:!1})},e.checkCurrentAccount=function(){var t=window.ethereum;t.autoRefreshOnNetworkChange=!1,t.on("accountsChanged",(function(t){e.setState({userAccount:t[0]}),e.checkEthBalance(t[0])}))},e.kingMe=Object(u.a)(l.a.mark((function t(){var n,a,o,r,c,s,i,u;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.state,a=n.userAccount,o=n.kingInputAmount,r=n.web3,c=n.contract,s=n.kingRansom,i=new v.a(s),new v.a(o)>=i+.1&&""!==o?(u=r.utils.toWei(o),c.methods.becomeKing().send({from:a,value:u}).on("receipt",(function(t){e.checkEthBalance(a),N(t)})).on("error",(function(e){console.log(e),R()})),e.setState({kingInputAmount:0}),M()):S();case 4:case"end":return t.stop()}}),t)}))),e.handleInputAmountChange=function(t){e.setState({kingInputAmount:t.target.value.toString()})},e.state={walletConnected:!1,userAccount:null,ethBalance:null,contractAddress:"0x2800cC9F11E0956B20FE48FcC8b69db310D93f02",kingAddress:null,kingRansom:null,kingInputAmount:"",contract:{},web3:{},coronationSub:null,loading:!0},e}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentWillUnmount",value:function(){var e=this.state.coronationSub;e&&e.unsubcribe()}},{key:"render",value:function(){var e=this.state,t=e.walletConnected,n=e.ethBalance,a=e.userAccount,r=e.kingAddress,c=e.kingRansom,s=e.kingInputAmount,i=e.loading;return o.a.createElement("div",null,t?o.a.createElement(j,{handleInputAmountChange:this.handleInputAmountChange,ethBalance:n,userAccount:a,kingAddress:r,kingInputAmount:s,kingRansom:c,kingMe:this.kingMe,loading:i}):o.a.createElement(O,{connectWallet:this.connectWallet}))}}]),t}(a.Component);var _=function(){return o.a.createElement("div",{className:"App"},o.a.createElement("div",{className:"App-container"},o.a.createElement(s,null),o.a.createElement(W,null)))};c.a.render(o.a.createElement(_,null),document.getElementById("root"))}},[[167,1,2]]]);
//# sourceMappingURL=main.f17ac0a8.chunk.js.map