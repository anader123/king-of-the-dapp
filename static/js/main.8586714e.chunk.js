(this["webpackJsonpking-of-the-dapp"]=this["webpackJsonpking-of-the-dapp"]||[]).push([[0],{108:function(e,t){e.exports={abi:[{constant:!1,inputs:[],name:"becomeKing",outputs:[],payable:!0,stateMutability:"payable",type:"function"},{inputs:[],payable:!0,stateMutability:"payable",type:"constructor"},{payable:!0,stateMutability:"payable",type:"fallback"},{anonymous:!1,inputs:[{indexed:!0,name:"_newKing",type:"address"},{indexed:!1,name:"_kingRansom",type:"uint256"}],name:"Coronation",type:"event"},{constant:!0,inputs:[],name:"King",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"kingRansom",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}]}},230:function(e,t,n){e.exports=n.p+"static/media/ethlogo.bdc70232.png"},232:function(e,t,n){e.exports=n(558)},237:function(e,t,n){},238:function(e,t,n){},239:function(e,t,n){},240:function(e,t,n){},241:function(e,t,n){},252:function(e,t){},287:function(e,t){},289:function(e,t){},339:function(e,t){},341:function(e,t){},372:function(e,t){},373:function(e,t){},415:function(e,t){},532:function(e,t,n){},558:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),o=n(107),i=n.n(o);n(237),n(238),n(239),n(240),n(241);function s(){return c.a.createElement("div",{className:"header-container"},c.a.createElement("h1",{className:"header-title"},"King of the Dapp"))}var l=n(69),r=n(70),u=n(72),m=n(71),d=n(73),h=n(28),p=n.n(h),g=n(108),k=n(109),f=n.n(k),b=(n(532),n(230)),E=n.n(b),v=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.connectMetaMask;return c.a.createElement("div",{className:"connect-container"},c.a.createElement("button",{onClick:e},"Connect MM"),c.a.createElement("a",{className:"mm-download",target:"_blank",rel:"noopener noreferrer",href:"https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn"},c.a.createElement("span",null,"Download MetaMask")))}}]),t}(a.Component),A=n(231),y=n.n(A);function C(e){var t=e.userAccount,n=e.ethBalance,a=e.kingRansom,o=e.kingAddress,i=e.kingMe,s=e.handleInputAmountChange,l=e.kingAmount,r=y.a.createDataURL({seed:o});return c.a.createElement("div",{className:"dashboard-container"},c.a.createElement("div",{className:"user-info-container"},c.a.createElement("p",{className:"user-address"},"Your Address: ",t),c.a.createElement("p",null,"Balance: ",n," ETH")),c.a.createElement("div",{className:"king-info-container"},c.a.createElement("img",{className:"blockie-img",alt:"eth-blockie",src:r}),c.a.createElement("p",{className:"king-name"},"King: ",o),c.a.createElement("p",null,"King's Ransom: ",a," ETH")),c.a.createElement("div",{className:"input-container"},c.a.createElement("input",{className:"input-box",onChange:s,value:l,type:"number"}),c.a.createElement("button",{className:"input-btn",onClick:i},"King Me"),c.a.createElement("p",{className:"input-text"},"*Enter an amount that is at least 0.1 ETH greater.")),c.a.createElement("p",{className:"medium-link"},"Read the tutorial on Medium."))}var M=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(u.a)(this,Object(m.a)(t).call(this))).connectMetaMask=function(){window.ethereum.enable().then((function(t){e.setState({metamaskConnected:!0,userAccount:t[0]}),e.checkEthBalance(t[0]),e.checkContractInfo(),e.checkCurrentAccount(),setInterval((function(){e.checkContractInfo()}),2e4)}))},e.kingMe=function(){var t=e.state,n=t.userAccount,a=t.kingAmount,o=t.contractAddress,i=new p.a(p.a.givenProvider||"http://localhost:8545"),s=new i.eth.Contract(g.abi,o),l={from:n,to:o,value:i.utils.toWei(a),data:s.methods.becomeKing().encodeABI()};i.eth.sendTransaction(l).then((function(e){f()({icon:"success",title:"Tx Successfully Sent",closeOnClickOutside:!1,content:c.a.createElement("div",null,c.a.createElement("p",null,"Transaction Hash:"),c.a.createElement("p",null,c.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://ropsten.etherscan.io/tx/".concat(e.transactionHash)},e.transactionHash)))})})).catch((function(e){console.log("err",e)})),e.setState({kingAmount:0}),setTimeout((function(){return e.blockchainMessage()}),1e3)},e.blockchainMessage=function(){f()({closeOnClickOutside:!1,button:!1,content:c.a.createElement("div",null,c.a.createElement("img",{className:"block-load-img",src:E.a,alt:"block loading"}),c.a.createElement("p",null,"Blockchain magic in progress..."),c.a.createElement("br",null))})},e.handleInputAmountChange=function(t){e.setState({kingAmount:t.target.value})},e.checkContractInfo=function(){var t=new p.a(p.a.givenProvider||"http://localhost:8545"),n=e.state.contractAddress,a=new t.eth.Contract(g.abi,n);a.methods.King().call((function(t,n){t?console.log(t):e.setState({kingAddress:n})})),a.methods.kingRansom().call((function(n,a){if(n)console.log(n);else{var c=+t.utils.fromWei(a);e.setState({kingRansom:c.toFixed(3)})}}))},e.checkCurrentAccount=function(){window.ethereum.on("accountsChanged",(function(t){e.setState({userAccount:t[0]}),e.checkEthBalance(t[0])}))},e.checkEthBalance=function(t){var n=new p.a(p.a.givenProvider||"http://localhost:8545");void 0!==t?n.eth.getBalance(t,(function(t,a){if(t)console.log(t);else{var c=+n.utils.fromWei(a);e.setState({ethBalance:c.toFixed(3)})}})):e.setState({metamaskConnected:!1})},e.state={metamaskConnected:!1,userAccount:null,ethBalance:null,contractAddress:"0xECdAb99dBa830F3a097c3bF97139E24Bd4A214d0",kingAddress:null,kingRansom:null,kingAmount:0},e}return Object(d.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state,t=e.metamaskConnected,n=e.ethBalance,a=e.userAccount,o=e.kingAddress,i=e.kingRansom,s=e.kingAmount;return c.a.createElement("div",null,t?c.a.createElement("div",null,c.a.createElement(C,{handleInputAmountChange:this.handleInputAmountChange,ethBalance:n,userAccount:a,kingAddress:o,kingAmount:s,kingRansom:i,kingMe:this.kingMe})):c.a.createElement("div",null,c.a.createElement(v,{connectMetaMask:this.connectMetaMask})))}}]),t}(a.Component);var w=function(){return c.a.createElement("div",{className:"App"},c.a.createElement("div",{className:"App-container"},c.a.createElement(s,null),c.a.createElement(M,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(c.a.createElement(w,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[232,1,2]]]);
//# sourceMappingURL=main.8586714e.chunk.js.map